<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIFF åˆ†äº«åŠŸèƒ½æ¸¬è©¦</title>
    <!-- å¼•å…¥ LIFF SDK -->
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            padding: 20px;
            text-align: center;
            background-color: #f0f0f0;
        }
        h1 { font-size: 24px; margin-bottom: 20px; }
        h2 { font-size: 16px; color: #555; margin-top: 30px; margin-bottom: 10px; border-bottom: 1px solid #ddd; padding-bottom: 10px;}
        
        /* æŒ‰éˆ•æ¨£å¼ */
        .btn {
            display: block;
            width: 100%;
            max-width: 400px;
            margin: 0 auto 15px auto;
            padding: 15px;
            font-size: 16px;
            font-weight: bold;
            color: white;
            border: none;
            border-radius: 8px;
            text-decoration: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: transform 0.1s, opacity 0.2s;
            cursor: pointer;
            opacity: 0.5; /* åˆå§‹æœªåˆå§‹åŒ–å‰åŠé€æ˜ */
            pointer-events: none; /* åˆå§‹ä¸å¯é»æ“Š */
        }
        .btn.ready {
            opacity: 1;
            pointer-events: auto;
        }
        .btn:active { transform: scale(0.98); }
        
        /* é¡è‰²å€åˆ† */
        .btn-xenda { background: linear-gradient(135deg, #E480BD 0%, #F69DDF 100%); }
        .btn-nnhcp { background: linear-gradient(135deg, #0133DA 0%, #05AAFF 100%); }
        
        /* å¤–éƒ¨ç€è¦½å™¨æ¨™è¨˜ */
        .external { position: relative; }
        .external::after {
            content: '(å¼·åˆ¶å¤–éƒ¨é–‹å•Ÿ)';
            display: block;
            font-size: 12px;
            font-weight: normal;
            margin-top: 4px;
            opacity: 0.9;
        }

        #status { font-size: 12px; color: #888; margin-bottom: 20px; }
        #error-msg { color: red; font-size: 12px; display: none; margin-top: 10px; }
    </style>
</head>
<body>

    <h1>LIFF åˆ†äº«æ¸¬è©¦å…¥å£</h1>
    <div id="status">LIFF åˆå§‹åŒ–ä¸­...</div>
    <div id="error-msg"></div>

    <!-- 1. çº–é”æ—¥è¨˜æ¸¬è©¦å€ -->
    <h2>ğŸŒ¸ çº–é”æ—¥è¨˜ (Xenda)</h2>
    
    <button onclick="openLink('xenda', false)" class="btn btn-xenda">
       åœ¨ LIFF å…§éƒ¨é–‹å•Ÿ
    </button>

    <button onclick="openLink('xenda', true)" class="btn btn-xenda external">
       å¤–éƒ¨ç€è¦½å™¨é–‹å•Ÿ
    </button>


    <!-- 2. NNHCP æ¸¬è©¦å€ -->
    <h2>ğŸ”µ NNHCP æ´»å‹•</h2>

    <button onclick="openLink('nnhcp', false)" class="btn btn-nnhcp">
       åœ¨ LIFF å…§éƒ¨é–‹å•Ÿ
    </button>

    <button onclick="openLink('nnhcp', true)" class="btn btn-nnhcp external">
       å¤–éƒ¨ç€è¦½å™¨é–‹å•Ÿ
    </button>

    <script>
        // ==========================================
        // âš ï¸ é‡è¦ï¼šè«‹åœ¨æ­¤è™•å¡«å…¥æ‚¨çš„ LIFF ID
        // ä¾‹å¦‚ï¼š'1657000000-xxxxxxxxx'
        // ==========================================
        const MY_LIFF_ID = '2004052521-mcLyBvRu'; 
        
        // è¨­å®šç›®æ¨™ç¶²å€ (é€™æ˜¯æ‚¨å…ˆå‰éƒ¨ç½²çš„ GitHub Pages ç¶²å€)
        const BASE_URL = 'https://yachang-chung-cloud.github.io/share-test/';
        const UID = 'U4643e5713229bd5b94bb00ad6dd4c6bd';

        // åˆå§‹åŒ– LIFF
        document.addEventListener('DOMContentLoaded', () => {
            if (MY_LIFF_ID === 'è«‹æ›¿æ›_æ‚¨çš„_LIFF_ID') {
                showError('éŒ¯èª¤ï¼šè«‹ç·¨è¼¯ HTML æª”æ¡ˆä¸¦å¡«å…¥æ­£ç¢ºçš„ LIFF ID');
                return;
            }

            liff.init({ liffId: MY_LIFF_ID })
                .then(() => {
                    // åˆå§‹åŒ–æˆåŠŸ
                    document.getElementById('status').textContent = 'LIFF Ready (å·²ç™»å…¥)';
                    if (!liff.isLoggedIn()) {
                        liff.login();
                    } else {
                        enableButtons();
                    }
                })
                .catch((err) => {
                    console.error(err);
                    showError('LIFF åˆå§‹åŒ–å¤±æ•—: ' + err.message);
                });
        });

        function enableButtons() {
            document.querySelectorAll('.btn').forEach(btn => {
                btn.classList.add('ready');
            });
        }

        function showError(msg) {
            const el = document.getElementById('error-msg');
            el.textContent = msg;
            el.style.display = 'block';
            document.getElementById('status').textContent = 'ç™¼ç”ŸéŒ¯èª¤';
        }

        /**
         * é–‹å•Ÿé€£çµçš„å‡½å¼
         * @param {string} campaign - æ´»å‹•ä»£ç¢¼ (xenda / nnhcp)
         * @param {boolean} isExternal - æ˜¯å¦å¼·åˆ¶ç”¨å¤–éƒ¨ç€è¦½å™¨é–‹å•Ÿ
         */
        function openLink(campaign, isExternal) {
            // çµ„åˆç›®æ¨™ç¶²å€
            const targetUrl = `${BASE_URL}?campaign=${campaign}&uid=${UID}`;

            if (isExternal) {
                // ä½¿ç”¨ LIFF SDK API å¼·åˆ¶å¤–éƒ¨é–‹å•Ÿ (è§£æ±º Android ç—›é»)
                liff.openWindow({
                    url: targetUrl,
                    external: true
                });
            } else {
                // åœ¨ LIFF å…§éƒ¨ç›´æ¥è·³è½‰
                window.location.href = targetUrl;
            }
        }
    </script>
</body>
</html>
